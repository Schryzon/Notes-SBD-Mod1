Berikut **daftar relasi** yang disusun ulang persis berdasarkan entitas yang kamu berikan. Aku berikan **2 versi**: **Unnormalized** (menunjukkan relasi ketika data masih denormal — mis. field list/duplikasi ada) dan **3NF** (versi final ternormalisasi). Tabel tiap baris berisi: Relasi, Kardinalitas (A : B), Partisipasi A, Partisipasi B, serta apakah itu **Agregasi** atau **Generalisasi** (atau catatan khusus).

---

# A. Unnormalized — relasi ketika tabel masih menyimpan atribut berganda/duplikasi (menggambarkan konsekuensi desain unnormalized)

| No | Relasi (A — B)                          | Kardinalitas (A : B) | Partisipasi A                                          | Partisipasi B                                                             | Agregasi / Generalisasi / Catatan                                                                          |
| -: | --------------------------------------- | -------------------: | ------------------------------------------------------ | ------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------- |
|  1 | `person` — `customer`                   |             1 : 0..1 | Parsial (person bisa bukan customer)                   | **Total** (customer harus punya person)                                   | **Generalisasi** (person → customer). Di unnormalized PDF sering field person disalin ke customer.         |
|  2 | `person` — `employee`                   |             1 : 0..1 | Parsial                                                | **Total** (employee harus punya person)                                   | **Generalisasi** (person → employee). Info person sering duplikat di employee row.                         |
|  3 | `customer` — `member`                   |             1 : 0..1 | Parsial                                                | **Total** (member adalah customer)                                        | **Generalisasi** (customer → member). Di unnormalized kadang hanya flag di customer.                       |
|  4 | `payment` — `customer`                  |                1 : N | Parsial (payment terkadang guest, tapi biasanya total) | Parsial (customer bisa belum pernah bayar)                                | Relasi biasa; di unnormalized customer detail sering disalin dalam payment (redundansi).                   |
|  5 | `payment` — `employee`                  |                1 : N | Parsial (payment sering mencatat kasir)                | Parsial                                                                   | Relasi biasa; nama pegawai sering tersimpan teks di payment (redundansi).                                  |
|  6 | `payment` — `voucher`                   |             1 : 0..1 | Parsial (banyak payment tanpa voucher)                 | Parsial (voucher bisa tak terpakai)                                       | Relasi biasa; unnormalized dapat menyimpan detail voucher di payment.                                      |
|  7 | `payment` — `payment_line`              |                1 : N | **Total** pada payment_line (line harus punya payment) | Parsial (payment bisa tersimpan sebagai satu row dengan kolom list items) | **Agregasi**. Pada unnormalized, `payment` sering menyimpan `items` sebagai string list (repeating group). |
|  8 | `payment_line` — `menu_item`            |                N : 1 | Total (line selalu refer ke menu_item)                 | Parsial                                                                   | Relasi biasa; menu_item info kadang disalin ke payment_line.                                               |
|  9 | `reservation` — `customer`              |                1 : N | Parsial (reservation biasanya butuh customer)          | Parsial                                                                   | Relasi biasa; nama & kontak customer sering disalin ke reservation.                                        |
| 10 | `reservation` — `employee` (handled_by) |          0..N : 0..1 | Parsial (reservation kadang belum ditangani)           | Parsial (employee bisa belum handle)                                      | Relasi opsional.                                                                                           |
| 11 | `event` — `event_participant`           |                1 : N | Parsial (event bisa tanpa peserta)                     | **Total** pada participant (participant harus punya event)                | **Agregasi**; unnormalized sering simpan peserta sebagai list di `event`.                                  |
| 12 | `event_participant` — `customer`        |                N : 1 | **Total** pada participant                             | Parsial                                                                   | Relasi junction; unnormalized bisa menyimpan nama peserta langsung di event.                               |
| 13 | `book` — `book_loan`                    |                1 : N | Parsial (buku bisa tidak dilunaskan)                   | **Total** pada loan                                                       | **Agregasi**; di unnormalized, informasi buku sering disalin tiap transaksi pinjam.                        |
| 14 | `book_loan` — `customer`                |                N : 1 | **Total** pada loan                                    | Parsial                                                                   | Relasi biasa.                                                                                              |
| 15 | `menu_item` — `category_lookup`         |                N : 1 | Parsial (menu_item biasanya punya kategori)            | Parsial                                                                   | Lookup relation; unnormalized sering menyimpan kategori teks.                                              |
| 16 | `menu_item` — `status_lookup`           |                N : 1 | Parsial (menu_item harus punya status)                 | Parsial                                                                   | Lookup relation; status sering teks di item.                                                               |
| 17 | `employee` — `role`                     |                N : 1 | Parsial (employee punya role)                          | Parsial                                                                   | Lookup; role sering disimpan sebagai teks di employee rows.                                                |
| 18 | `voucher` — `status_lookup`             |                N : 1 | Parsial                                                | Parsial                                                                   | Lookup; voucher status sering disalin ke payment.                                                          |
| 19 | `feedback` — `customer`                 |                1 : N | Parsial (feedback bisa anonim)                         | Parsial                                                                   | Relasi biasa; unnormalized menyimpan nama pengirim di feedback.                                            |
| 20 | `audit_log` — `person`                  |                N : 1 | Parsial                                                | Parsial                                                                   | Audit references actor; di unnormalized audit kadang tidak ada atau gabung field deskriptif.               |

---

# B. 3NF — relasi setelah normalisasi penuh (FK jelas, tidak ada duplikasi atribut, struktur seperti yang kamu sebut)

| No | Relasi (A — B)                                  |             Kardinalitas (A : B) | Partisipasi A                                             | Partisipasi B                                                | Agregasi / Generalisasi / Catatan                                                                      |
| -: | ----------------------------------------------- | -------------------------------: | --------------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------ |
|  1 | `person` — `customer`                           |                         1 : 0..1 | Parsial (person tidak selalu customer)                    | **Total** (customer ∈ person)                                | **Generalisasi**: `customer` IS-A `person` (implementasi: FK customer.customer_id → person.person_id). |
|  2 | `person` — `employee`                           |                         1 : 0..1 | Parsial                                                   | **Total** (employee ∈ person)                                | **Generalisasi**: `employee` IS-A `person`.                                                            |
|  3 | `customer` — `member`                           |                         1 : 0..1 | Parsial                                                   | **Total** (member ∈ customer)                                | **Generalisasi**: `member` IS-A `customer`.                                                            |
|  4 | `customer` — `reservation`                      |                            1 : N | Parsial (customer boleh tanpa reservation)                | **Total** (reservation harus refer customer)                 | Relasi biasa (reservation HAS-A customer).                                                             |
|  5 | `reservation` — `status_lookup`                 |                            N : 1 | **Total** pada reservation (status wajib)                 | Parsial                                                      | Lookup relation (status enum terpisah).                                                                |
|  6 | `reservation` — `employee` (handled_by)         |                      0..N : 0..1 | Parsial (reservation bisa null handled_by)                | Parsial                                                      | Relasi opsional.                                                                                       |
|  7 | `payment` — `customer`                          |                            1 : N | Parsial (guest possible → nullable)                       | Parsial                                                      | Relasi biasa; di 3NF payment hanya menyimpan FK customer_id.                                           |
|  8 | `payment` — `employee`                          |                            1 : N | Parsial (payment biasanya dicatat oleh employee)          | Parsial                                                      | Relasi biasa.                                                                                          |
|  9 | `payment` — `payment_method`                    |                            N : 1 | **Total** (payment wajib punya method)                    | Parsial                                                      | Lookup relation.                                                                                       |
| 10 | `payment` — `voucher`                           |                         N : 0..1 | Parsial                                                   | Parsial                                                      | Relasi biasa (nullable FK).                                                                            |
| 11 | `payment` — `payment_line`                      |                            1 : N | **Total** pada payment_line                               | Parsial (payment mungkin memiliki 0..N lines but usually ≥1) | **Agregasi** (payment HAS MANY payment_line).                                                          |
| 12 | `payment_line` — `menu_item`                    |                            N : 1 | **Total** pada payment_line                               | Parsial                                                      | Relasi biasa (menu reference).                                                                         |
| 13 | `menu_item` — `category_lookup`                 |                            N : 1 | **Total** pada menu_item                                  | Parsial                                                      | Lookup relation.                                                                                       |
| 14 | `menu_item` — `status_lookup`                   |                            N : 1 | **Total** pada menu_item                                  | Parsial                                                      | Lookup relation for availability.                                                                      |
| 15 | `employee` — `role`                             | N : 1 (or M:N via employee_role) | **Total** pada employee if single role                    | Parsial                                                      | Jika employee bisa multi-role, modelkan M:N dengan `employee_role`.                                    |
| 16 | `event` — `event_participant`                   |                            1 : N | Parsial (event mungkin tanpa peserta)                     | **Total** pada participant                                   | **Agregasi** (event HAS MANY participants).                                                            |
| 17 | `event_participant` — `customer`                |                            N : 1 | **Total** pada participant                                | Parsial                                                      | Junction table untuk M:N event–customer (PK composite: event_id, customer_id).                         |
| 18 | `book` — `book_loan`                            |                            1 : N | Parsial (book bisa tak dipinjam)                          | **Total** pada loan                                          | **Agregasi** (book HAS MANY loans).                                                                    |
| 19 | `book_loan` — `customer`                        |                            N : 1 | **Total** pada loan                                       | Parsial                                                      | Relasi biasa.                                                                                          |
| 20 | `book_loan` — `status_lookup`                   |                            N : 1 | **Total** pada loan                                       | Parsial                                                      | Loan status (pinjam, terlambat, dikembalikan).                                                         |
| 21 | `voucher` — `status_lookup`                     |                            N : 1 | **Total** pada voucher                                    | Parsial                                                      | Lookup relation untuk voucher state.                                                                   |
| 22 | `voucher` — `category_lookup` (voucher_type_id) |                            N : 1 | Parsial                                                   | Parsial                                                      | Mengkategorikan jenis voucher/promo.                                                                   |
| 23 | `feedback` — `customer`                         |                            1 : N | Parsial (feedback mungkin anonim if customer_id nullable) | Parsial                                                      | Relasi biasa; simpan FK customer_id nullable jika anonim diizinkan.                                    |
| 24 | `audit_log` — `person` (actor_person_id)        |                            N : 1 | Parsial                                                   | Parsial                                                      | Audit refer ke person sebagai actor.                                                                   |
| 25 | `person` — `audit_log` (target)                 |                            1 : N | Parsial                                                   | Parsial                                                      | Jika audit target adalah person (target_table/target_id generic).                                      |

---

# Penjelasan singkat partisipasi penting (3NF)

* Transaksi / event rows yang *mewakili kejadian* (mis. `reservation`, `payment`, `book_loan`, `payment_line`, `event_participant`) **harus** mereferensi entitas induk → partisipasi mereka terhadap FK umumnya **Total** (tidak boleh NULL).
* Lookup / master data (`person`, `role`, `category_lookup`, `status_lookup`, `payment_method`) biasanya **Parsial** — mereka bisa ada tanpa referensi transaksi.
* Generalisasi (IS-A) selalu: child **Total** ke parent; parent **Parsial** (satu person bisa jadi bukan customer/employee).
